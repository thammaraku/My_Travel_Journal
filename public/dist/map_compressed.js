let map,service,infowindow,memberEmail,userListArr=[],newAddArr=[],geoLocationObj={};function initMap(){const a=new google.maps.Map(document.getElementById("map"),{zoom:4}),b=new google.maps.LatLngBounds;if(1===userListArr.length){const a=new google.maps.LatLng(userListArr[0].lat,userListArr[0].lang),b=new google.maps.Map(document.getElementById("map"),{zoom:12,center:new google.maps.LatLng(userListArr[0].lat,userListArr[0].lang)}),c=new google.maps.Marker({position:new google.maps.LatLng(userListArr[0].lat,userListArr[0].lang),map:b})}else{for(i=0;i<userListArr.length;i++){const c=new google.maps.LatLng(userListArr[i].lat,userListArr[i].lang),d=new google.maps.Marker({position:c,map:a});b.extend(c)}a.fitBounds(b)}}function postLocation(a){console.log("postLocations = "+a),console.log("postLocations.place = "+a.place),console.log("postLocations.lat = "+a.lat),console.log("postLocations.lang = "+a.lang);const b=a.place,c=a.lat,d=a.lang;$.post("/api/location",{place:b,latitude:c,longitude:d}).then(function(){})}function getGeolocation(a){infowindow=new google.maps.InfoWindow;var b=new google.maps.Map(document.getElementById("map"));service=new google.maps.places.PlacesService(b),service.findPlaceFromQuery({query:a,fields:["name","geometry"]},(c,d)=>{if(d===google.maps.places.PlacesServiceStatus.OK)for(let d=0;d<c.length;d++){infowindow.setContent(c[d].name),infowindow.open(b);var e=c[d].geometry.location.lat(),f=c[d].geometry.location.lng();collectUserSearch({place:a,lat:e,lang:f})}})}function collectUserSearch(a){console.log("collectUserSearc geoLocationObj = "+a),userListArr.push(a),initMap(userListArr),console.log("under collectUserSearch before postLocation geoLocationObj = "+a),postLocation(a)}function renderJournal(){if(console.log("userListArr.length under renderJournal = "+userListArr.length),userListArr)for(var a=0;a<userListArr.length;++a)$(`#row${a}`).html(`<td><p class="">${userListArr[a].place} ${userListArr[a].date}
      <button class="" style="float:right"><i class="fas fa-trash-alt"></i></button>
      <button class="" style="float:right"><i class="fas fa-camera"></i></button></p>
      <p class="">${userListArr[a].journal}</p>
      </td>`)}function landingMap(){console.log("newAddArr.length under landingMap = "+[].length);new google.maps.Map(document.getElementById("map"),{zoom:2,center:new google.maps.LatLng(37.0902,-95.7129),mapTypeId:"satellite"})}function handleSearchBtnSubmit(a){a.preventDefault,console.log("under handleSearchBtnSubmit memberEmail = "+memberEmail);var b={userEmail:memberEmail,placeName:$("#placeForm").val(),date:$("#date").val(),journal:$("#journal-body").val(),tripName:$("#tripName").val()};getGeolocation(b.placeName),postJournal(b),newAddArr.push(b),renderJournal2(newAddArr),$("#placeForm").val(""),$("#date").val(""),$("#journal-body").val("")}function renderJournal2(a){console.log("newAddArr.length under renderJournal2 = "+a.length);for(var b=0;b<a.length;++b)console.log("newAddArr[i].placeName = "+a[b].placeName),console.log("newAddArr[i].date = "+a[b].date),console.log("newAddArr[i].journal = "+a[b].journal),console.log("newAddArr[i].tripName = "+a[b].tripName),$(`#row${b}`).html(`<td class="journal_table"><p>${a[b].placeName} - ${a[b].date}
  <button class="" style="float:right"><i class="fas fa-trash-alt"></i></button>
  <button class="" style="float:right"><i class="fas fa-camera"></i></button></p>
  <p class="">${a[b].journal}</p>
  </td>`)}function postJournal(a){const b=a.userEmail,c=a.tripName,d=a.placeName,e=a.date,f=a.journal;$.post("/api/journal",{userEmail:b,journalTitle:c,location:d,start_date:e,journalEntry:f}).then(function(){alert("Adding journal...")})}function handlePushBtnSubmit(a){a.preventDefault,$("#placeForm").val(""),$("#date").val(""),$("#journal-body").val(""),$("#tripName").val(""),$(".journal_table").remove(),newAddArr=[],userListArr=[],geoLocationObj={},landingMap()}$(document).ready(function(){0===userListArr.length?landingMap():initMap(userListArr),$(document).on("click","#searchBtn",handleSearchBtnSubmit),console.log("after serachButton newAddArr.length = "+newAddArr.length),$(document).on("click","#pushBtn",handlePushBtnSubmit)});